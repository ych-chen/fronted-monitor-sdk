# Frontend Monitor SDK æ¶æ„è®¾è®¡

## ğŸ“ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend Monitor SDK                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  index.ts (ä¸»å…¥å£)                                            â”‚
â”‚  â”œâ”€â”€ FrontendMonitorSDKImpl (ä¸»SDKç±»)                         â”‚
â”‚  â”œâ”€â”€ ç±»å‹å¯¼å‡ºå’Œå·¥å‚å‡½æ•°                                        â”‚
â”‚  â””â”€â”€ æ¨¡å—èšåˆ                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                 â”‚                 â”‚
              â–¼                 â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   trace/        â”‚  â”‚   metrics/      â”‚  â”‚   config/       â”‚
    â”‚   (é“¾è·¯è¿½è¸ª)     â”‚  â”‚   (æ€§èƒ½æŒ‡æ ‡)     â”‚  â”‚   (é…ç½®ç®¡ç†)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” é“¾è·¯è¿½è¸ªæ¨¡å— (trace/)

```
trace/
â”œâ”€â”€ tracer.ts                     # TraceManager - è¿½è¸ªç®¡ç†å™¨
â”œâ”€â”€ instrumentation/               # è‡ªåŠ¨instrumentation
â”‚   â”œâ”€â”€ index.ts                # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ xhr-instrumentation.ts  # XMLHttpRequestè‡ªåŠ¨è¿½è¸ª
â”‚   â””â”€â”€ fetch-instrumentation.ts # Fetch APIè‡ªåŠ¨è¿½è¸ª
â””â”€â”€ â””â”€â”€ (ä½¿ç”¨OpenTelemetry API)
```

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- è‡ªåŠ¨æ‹¦æˆªXMLHttpRequestå’ŒFetch API
- åˆ›å»ºå’Œç®¡ç†span
- æ³¨å…¥traceå¤´è¿›è¡Œé“¾è·¯ä¼ æ’­
- è®°å½•è¯·æ±‚/å“åº”ä¿¡æ¯å’Œæ€§èƒ½æŒ‡æ ‡

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡æ¨¡å— (metrics/)

```
metrics/
â”œâ”€â”€ index.ts          # æ¨¡å—å…¥å£
â”œâ”€â”€ performance.ts    # PerformanceCollector - è‡ªåŠ¨æ€§èƒ½æŒ‡æ ‡
â””â”€â”€ custom.ts         # CustomMetricsCollector - è‡ªå®šä¹‰æŒ‡æ ‡
```

### performance.ts - è‡ªåŠ¨æ€§èƒ½æŒ‡æ ‡
```
PerformanceCollector
â”œâ”€â”€ FCP (First Contentful Paint)
â”œâ”€â”€ LCP (Largest Contentful Paint)
â”œâ”€â”€ FID (First Input Delay)
â”œâ”€â”€ CLS (Cumulative Layout Shift)
â”œâ”€â”€ TTFB (Time to First Byte)
â””â”€â”€ Navigation Timing
```

### custom.ts - è‡ªå®šä¹‰æŒ‡æ ‡ç³»ç»Ÿ
```
CustomMetricsCollector
â”œâ”€â”€ Counter (è®¡æ•°å™¨)
â”œâ”€â”€ Histogram (ç›´æ–¹å›¾)
â”œâ”€â”€ Gauge (ä»ªè¡¨ç›˜)
â””â”€â”€ ä¸šåŠ¡æŒ‡æ ‡å°è£…
    â”œâ”€â”€ recordHTTPRequest()
    â”œâ”€â”€ recordUserAction()
    â”œâ”€â”€ recordEvent()
    â””â”€â”€ recordBusinessMetric()
```

## âš™ï¸ é…ç½®ç®¡ç† (config/)

```
config/
â””â”€â”€ default-config.ts
    â”œâ”€â”€ DEFAULT_CONFIG        # é»˜è®¤SDKé…ç½®
    â”œâ”€â”€ PERFORMANCE_CONFIG    # æ€§èƒ½æŒ‡æ ‡é…ç½®
    â”œâ”€â”€ AUTO_TRACE_CONFIG     # è‡ªåŠ¨è¿½è¸ªé…ç½®
    â””â”€â”€ INTERACTION_CONFIG    # äº¤äº’ç›‘æ§é…ç½®
```

## ğŸ”„ æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ä»£ç    â”‚    â”‚  SDKæ ¸å¿ƒ   â”‚    â”‚ OpenTelemetryâ”‚
â”‚             â”‚    â”‚             â”‚    â”‚    åŸºç¡€è®¾æ–½   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    äº‹ä»¶ç›‘å¬å’Œè‡ªåŠ¨æ•è·                    â”‚
â”‚  â€¢ XMLHttpRequest/Fetch è‡ªåŠ¨è¿½è¸ª                          â”‚
â”‚  â€¢ JavaScript é”™è¯¯æ•è·                                    â”‚
â”‚  â€¢ ç”¨æˆ·äº¤äº’äº‹ä»¶ç›‘å¬                                        â”‚
â”‚  â€¢ æ€§èƒ½æŒ‡æ ‡è‡ªåŠ¨é‡‡é›†                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å¤„ç†å±‚                            â”‚
â”‚  â€¢ æ ‡å‡†åŒ–å’Œè¿‡æ»¤                                           â”‚
â”‚  â€¢ æŒ‡æ ‡èšåˆå’Œè½¬æ¢                                         â”‚
â”‚  â€¢ é”™è¯¯æ ¼å¼åŒ–å’Œä¸Šä¸‹æ–‡æ·»åŠ                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OTLP å¯¼å‡ºå±‚                           â”‚
â”‚  â€¢ Trace Exporter (HTTP/HTTPS)                          â”‚
â”‚  â€¢ Metric Exporter (HTTP/HTTPS)                          â”‚
â”‚  â€¢ æ‰¹é‡å¤„ç†å’Œå‹ç¼©                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åç«¯æ”¶é›†å™¨                              â”‚
â”‚  â€¢ Jaeger / Zipkin / Tempo / Grafana                   â”‚
â”‚  â€¢ OpenTelemetry Collector                              â”‚
â”‚  â€¢ è‡ªå®šä¹‰æ”¶é›†å™¨                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. **æ¨¡å—åŒ–è®¾è®¡**
- æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œå¯æŒ‰éœ€å¯ç”¨/ç¦ç”¨
- æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œå’ŒèŒè´£åˆ†ç¦»
- æ”¯æŒæ¸è¿›å¼é›†æˆ

### 2. **æ€§èƒ½ä¼˜å…ˆ**
- å¼‚æ­¥å¤„ç†ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹
- æ‰¹é‡æ•°æ®å¤„ç†ï¼Œå‡å°‘ç½‘ç»œå¼€é”€
- æ™ºèƒ½é‡‡æ ·æ§åˆ¶

### 3. **æ ‡å‡†åŒ–å…¼å®¹**
- éµå¾ªOpenTelemetryæ ‡å‡†
- æ”¯æŒOTLPåè®®
- å…¼å®¹ä¸»æµæ”¶é›†å™¨

### 4. **ç±»å‹å®‰å…¨**
- å®Œæ•´çš„TypeScriptæ”¯æŒ
- ä¸¥æ ¼çš„ç±»å‹å®šä¹‰
- ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥

### 5. **æ˜“ç”¨æ€§**
- ç®€å•çš„APIè®¾è®¡
- ä¸°å¯Œçš„é…ç½®é€‰é¡¹
- è¯¦ç»†çš„æ–‡æ¡£å’Œç¤ºä¾‹

## ğŸ”§ æ‰©å±•ç‚¹

### è‡ªå®šä¹‰Instrumentation
```typescript
// å¯ä»¥è½»æ¾æ‰©å±•æ”¯æŒå…¶ä»–API
class GraphQLInstrumentation {
  constructor(traceManager: TraceManager) {
    this.traceManager = traceManager;
  }

  patchGraphQL() {
    // GraphQLæ‹¦æˆªé€»è¾‘
  }
}
```

### è‡ªå®šä¹‰æŒ‡æ ‡
```typescript
// å¯ä»¥è½»æ¾æ‰©å±•æŒ‡æ ‡ç±»å‹
interface AdvancedMetricsCollector extends CustomMetricsCollector {
  createSummary(name: string): Summary;
  createUpDownCounter(name: string): UpDownCounter;
}
```

### è‡ªå®šä¹‰å¯¼å‡ºå™¨
```typescript
// å¯ä»¥è½»æ¾æ‰©å±•æ”¯æŒå…¶ä»–å¯¼å‡ºæ ¼å¼
class CustomTraceExporter {
  export(spans: Span[]) {
    // è‡ªå®šä¹‰å¯¼å‡ºé€»è¾‘
  }
}
```